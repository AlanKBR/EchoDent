{% extends "base.html" %}
{% block title %}DevLogs - EchoDent{% endblock %}
{% block content %}
<h1>Logs de Erro do Desenvolvedor</h1>
<form id="purge-logs-form" hx-post="/admin/devlogs/purge" hx-confirm="Tem certeza que deseja apagar TODOS os logs?" hx-target="body" hx-swap="none">
  <button type="submit" class="btn btn-danger mb-3">Purgar Todos os Logs</button>
</form>
<table class="table table-striped table-bordered">
  <thead>
    <tr>
  <th>ID</th>
  <th>Data/Hora</th>
  <th>Tipo de Erro</th>
  <th>URL</th>
  <th>Ações</th>
    </tr>
  </thead>
  <tbody>
    {% for log in pagination.items %}
    <tr>
      <td>{{ log.id }}</td>
      <td>{{ log.timestamp.strftime('%d/%m/%Y %H:%M:%S') if log.timestamp else '' }}</td>
      <td>{{ log.error_type }}</td>
      <td><span class="text-wrap-break">{{ log.request_url }}</span></td>
      <td>
        <a class="btn btn-sm btn-primary" href="{{ url_for('admin_bp.view_log_detail', log_id=log.id) }}">Ver Detalhes</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
<div class="pagination-controls mt-3">
  <nav aria-label="Paginação de logs">
    <ul class="pagination">
      {% if pagination.has_prev %}
        <li class="page-item">
          <a class="page-link" href="?page={{ pagination.prev_num }}">Anterior</a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">Anterior</span></li>
      {% endif %}
      <li class="page-item disabled"><span class="page-link">Página {{ pagination.page }} de {{ pagination.pages }}</span></li>
      {% if pagination.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ pagination.next_num }}">Próximo</a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">Próximo</span></li>
      {% endif %}
    </ul>
  </nav>
</div>
{% endblock %}
